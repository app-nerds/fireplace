const objectToMap=(e={})=>{let t=new Map;for(const s in e)t.set(s,e[s]);return t},fetch=window.fetch.bind(window);class Router{constructor(e,t,s=null){this.targetEl=e,this.routes=t,this.pageNotFoundView=s,this.pageNotFoundView?this.routes.push({path:"/404notfound/:path",view:this.pageNotFoundView}):this.routes.push({path:"/404notfound/:path",view:DefaultPageNotFound})}_pathToRegex(e){return new RegExp("^"+e.replace(/\//g,"\\/").replace(/:\w+/g,"(.+)")+"$")}_getParams(e){var t=e.result.slice(1),s=Array.from(e.route.path.matchAll(/:(\w+)/g)).map(e=>e[1]);let a={};for(let e=0;e<t.length;e++)a[s[e]]=t[e];return a}async _route(e){let t={};e.state&&(t=e.state);const s=this.routes.map(e=>({route:e,result:location.pathname.match(this._pathToRegex(e.path))}));let a=s.find(e=>null!==e.result);if(a){e=this._getParams(a);const o=new a.route.view(e);o.state=t;const n=document.querySelector(this.targetEl);n.innerHTML="",n.appendChild(o)}else this.navigateTo(`/404notfound${location.pathname}`)}getQueryParam(e){let t=new URLSearchParams(location.search);return t.get(e)}navigateTo(e,t={},s={}){let a="";if(0<Object.keys(t).length){var o,n,t=objectToMap(t);a+="?";for([o,n]of t){var r=encodeURIComponent(o);let e=n;"Object"!=typeof n&&"Array"!=typeof n||(e=JSON.stringify(n));var i=encodeURIComponent(e);a+=`${r}=${i}&`}}history.pushState(s,null,`${e}${a}`),this._route({state:s})}}const application=async(e,t,s=null)=>{window._router=new Router(e,t,s),window.addEventListener("popstate",e=>{window._router._route({state:e.state})}),window._router._route({})};class BaseView extends HTMLElement{constructor(e){super(),this._title="",this.params=e,this._state={},this.router=window._router,this.displaySuccessMessage=displaySuccessMessage,this.displayErrorMessage=displayErrorMessage,this.displayInformationMessage=displayInformationMessage}async connectedCallback(){await this.beforeRender(),await this.render(),this._setDocumentTitle(),await this.afterRender()}disconnectedCallback(){this.onUnload()}_setDocumentTitle(){var e=this.querySelectorAll("title");e&&0<e.length&&(this._title=e[0].innerText,document.title=this._title,this.removeChild(e[0]))}async beforeRender(){}async afterRender(){}async onUnload(){}async render(){throw new Error("not implemented")}get title(){return this._title}get html(){return this._html}get state(){return this._state}set state(e){this._state=e}getQueryParam(e){return this.router.getQueryParam(e)}navigateTo(e,t={},s={}){this.router.navigateTo(e,t,s)}}class DefaultPageNotFound extends BaseView{constructor(e){super(e)}async render(){return`
			<title>Page Not Found</title>
			<p>The page ${this.params.path} could not be found.</p>
		`}}class MessageBox extends HTMLElement{constructor(){super()}connectedCallback(){let e=document.createElement("div");e.classList.add("message-box"),e.innerHTML=this.getAttribute("message");var t=this.getAttribute("type");"success"===t?e.classList.add("success-box"):"information"===t?e.classList.add("information-box"):e.classList.add("error-box"),this.appendChild(e),e.style.animation="fadeIn 0.6s",e.style.display="block",setTimeout(()=>{e.style.animation="fadeOut 0.6s"},parseInt(this.getAttribute("duration")))}}function _displayMessageBox(e,t,s){let a=new MessageBox;a.setAttribute("type",t),a.setAttribute("message",e),a.setAttribute("duration",s),document.body.appendChild(a),setTimeout(()=>{document.body.removeChild(a)},parseInt(s)+300)}function displaySuccessMessage(e,t=3500){_displayMessageBox(e,"success",t)}function displayInformationMessage(e,t=3500){_displayMessageBox(e,"information",t)}function displayErrorMessage(e,t=3500){_displayMessageBox(e,"error",t)}customElements.define("message-box",MessageBox),customElements.define("default-page-not-found",DefaultPageNotFound);export{objectToMap,fetch,application,BaseView,displaySuccessMessage,displayInformationMessage,displayErrorMessage};